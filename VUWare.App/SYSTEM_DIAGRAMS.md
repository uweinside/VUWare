# VUWare.App - Visual System Documentation

## Application Startup Sequence

```
???????????????????????????????????????????????????????????????????
? MainWindow Created                                              ?
???????????????????????????????????????????????????????????????????
                   ?
                   ?
???????????????????????????????????????????????????????????????????
? MainWindow.Loaded Event                                         ?
?                                                                 ?
? 1. MapDialButtons() - Connect UI buttons to config UIDs         ?
? 2. LoadConfiguration() - Load & validate dials-config.json      ?
? 3. StartInitialization() - Create init service                 ?
???????????????????????????????????????????????????????????????????
                   ?
                   ?
????????????????????????????????????????????????????????????????????
? BACKGROUND THREAD: AppInitializationService                     ?
?                                                                  ?
?  Stage 1: "Connecting Dials" (Yellow)                           ?
?  ?? VU1Controller.AutoDetectAndConnect()                        ?
?  ?? Scan COM ports for VU1 Hub                                  ?
?  ?? Return to MainWindow                                        ?
?      ?? StatusButton.Content = "Connecting Dials"              ?
?      ?? StatusButton.Background = Yellow                       ?
?                                                                  ?
?  Stage 2: "Initializing Dials" (Yellow)                         ?
?  ?? VU1Controller.InitializeAsync()                             ?
?  ?? Scan I2C bus for dials                                      ?
?  ?? Set each dial to 0% + normal color                          ?
?  ?? Return to MainWindow                                        ?
?      ?? StatusButton.Content = "Initializing Dials"            ?
?      ?? StatusButton.Background = Yellow                       ?
?                                                                  ?
?  Stage 3: "Connecting HWInfo Sensors" (Yellow)                  ?
?  ?? HWInfo64Controller.Connect()                                ?
?  ?? Open shared memory connection                               ?
?  ?? For each enabled dial in config:                            ?
?  ?  ?? Create DialSensorMapping                                 ?
?  ?  ?? Register with HWInfo64Controller                         ?
?  ?? Return to MainWindow                                        ?
?      ?? StatusButton.Content = "Connecting HWInfo Sensors"     ?
?      ?? StatusButton.Background = Yellow                       ?
?                                                                  ?
?  Stage 4: "Monitoring" (Green)                                  ?
?  ?? Fire OnInitializationComplete event                         ?
?  ?? Ready for sensor monitoring                                 ?
?      ?? StatusButton.Content = "Monitoring"                    ?
?      ?? StatusButton.Background = Green                        ?
???????????????????????????????????????????????????????????????????
                   ?
                   ?
????????????????????????????????????????????????????????????????????
? InitService_OnInitializationComplete() Event                    ?
? (Back on Main Thread)                                            ?
?                                                                  ?
? StartMonitoring()                                                ?
? ?? Create SensorMonitoringService                               ?
?    ?? Register OnDialUpdated event handler                      ?
?    ?? Register OnError event handler                            ?
?    ?? service.Start()                                           ?
???????????????????????????????????????????????????????????????????
                   ?
                   ?
????????????????????????????????????????????????????????????????????
? BACKGROUND THREAD: SensorMonitoringService                      ?
? MonitoringLoop (runs every GlobalUpdateIntervalMs)              ?
?                                                                  ?
? while (isMonitoring)                                             ?
? {                                                                ?
?   For each enabled dial in config:                              ?
?   {                                                              ?
?     1. GetSensorStatus(dialUid)                                  ?
?        ?? Ask HWInfo64Controller for current reading            ?
?        ?? Value: 62.5 °C                                        ?
?        ?? MinValue: 20°C, MaxValue: 95°C                        ?
?        ?? Return SensorStatus with percentage calc              ?
?                                                                  ?
?     2. CalculatePercentage()                                    ?
?        ?? (62.5 - 20) / (95 - 20) * 100 = 66%                  ?
?                                                                  ?
?     3. DetermineColor()                                         ?
?        ?? Check: value >= criticalThreshold (88°C)?             ?
?        ?  ?? NO                                                 ?
?        ?? Check: value >= warningThreshold (75°C)?              ?
?        ?  ?? NO                                                 ?
?        ?? Use normalColor = Green                               ?
?                                                                  ?
?     4. UpdateDial()                                              ?
?        ?? SetDialPercentageAsync(dialUid, 66)                   ?
?        ?? SetBacklightColorAsync(dialUid, Green)                ?
?                                                                  ?
?     5. FireUpdateEvent()                                        ?
?        ?? Fire OnDialUpdated(dialUid, update)                   ?
?           ?? Dispatcher.Invoke() to Main Thread                 ?
?   }                                                              ?
?   Sleep(GlobalUpdateIntervalMs)                                 ?
? }                                                                ?
???????????????????????????????????????????????????????????????????
                   ?
                   ?
????????????????????????????????????????????????????????????????????
? MonitoringService_OnDialUpdated(dialUid, update) Event          ?
? (Back on Main Thread)                                            ?
?                                                                  ?
? var button = GetDialButton("290063000750524834313020")           ?
? ?? Returns Dial2Button                                          ?
?                                                                  ?
? UpdateButtonAppearance()                                         ?
? ?? if (update.IsCritical)                                       ?
? ?   ?? button.Background = Red                                  ?
? ?? else if (update.IsWarning)                                   ?
? ?   ?? button.Background = Orange                               ?
? ?? else                                                          ?
?     ?? button.Background = Green                                ?
?                                                                  ?
? button.Content = "66%"                                           ?
?                                                                  ?
? button.ToolTip = "CPU Temperature\n" +                          ?
?                  "Sensor: CPU (Tctl/Tdie)\n" +                  ?
?                  "Value: 62.5 °C\n" +                           ?
?                  "Dial: 66%\n" +                                ?
?                  "Color: Green\n" +                             ?
?                  "Updates: 1234\n" +                            ?
?                  "Last: 14:32:45"                               ?
????????????????????????????????????????????????????????????????????
```

## Configuration Data Flow

```
???????????????????????????????????????????????????????????????????
? dials-config.json                                               ?
???????????????????????????????????????????????????????????????????
                  ?
                  ?
???????????????????????????????????????????????????????????????????
? ConfigManager.LoadDefault()                                     ?
?                                                                 ?
? 1. Check AppData/VUWare/dials-config.json                       ?
? 2. If not found, check Config/dials-config.json                 ?
? 3. Parse JSON ? DialsConfiguration object                       ?
???????????????????????????????????????????????????????????????????
                  ?
                  ?
???????????????????????????????????????????????????????????????????
? DialsConfiguration                                              ?
?                                                                 ?
? ?? AppSettings                                                  ?
? ?  ?? autoConnect: true                                         ?
? ?  ?? enablePolling: true                                       ?
? ?  ?? globalUpdateIntervalMs: 1000                              ?
? ?  ?? logFilePath: ""                                           ?
? ?  ?? debugMode: false                                          ?
? ?                                                               ?
? ?? Dials[]                                                      ?
?    ?? Dial 0                                                    ?
?    ?  ?? dialUid: "290063000750524834313020"                    ?
?    ?  ?? displayName: "CPU Temperature"                         ?
?    ?  ?? sensorName: "CPU [#0]: AMD Ryzen 7 9700X: Enhanced"   ?
?    ?  ?? entryName: "CPU (Tctl/Tdie)"                           ?
?    ?  ?? minValue: 20                                           ?
?    ?  ?? maxValue: 95                                           ?
?    ?  ?? warningThreshold: 75                                   ?
?    ?  ?? criticalThreshold: 88                                  ?
?    ?  ?? colorConfig                                            ?
?    ?  ?  ?? normalColor: "Green"                                ?
?    ?  ?  ?? warningColor: "Orange"                              ?
?    ?  ?  ?? criticalColor: "Red"                                ?
?    ?  ?? enabled: true                                          ?
?    ?  ?? updateIntervalMs: 1000                                 ?
?    ?                                                             ?
?    ?? Dial 1-3...                                               ?
???????????????????????????????????????????????????????????????????
                  ?
        ??????????????????????
        ?                    ?
        ?                    ?
????????????????????  ????????????????????
? InitService      ?  ? MonitoringService?
?                  ?  ?                  ?
? Uses:            ?  ? Uses:            ?
? • dialUid        ?  ? • sensorName     ?
? • entryName      ?  ? • entryName      ?
? • colorConfig    ?  ? • minValue       ?
? • enabled        ?  ? • maxValue       ?
? • All values...  ?  ? • warningThresh  ?
?                  ?  ? • criticalThresh ?
?                  ?  ? • colorConfig    ?
?                  ?  ? • enabled        ?
????????????????????  ????????????????????
```

## Sensor Value to Dial Percentage Mapping

```
???????????????????????????????????????????????????????????????????
? Example: CPU Temperature                                        ?
?                                                                 ?
? Configuration:                                                  ?
?   minValue: 20°C                                                ?
?   maxValue: 95°C                                                ?
?   warningThreshold: 75°C                                        ?
?   criticalThreshold: 88°C                                       ?
???????????????????????????????????????????????????????????????????
                  ?
                  ?
???????????????????????????????????????????????????????????????????
? Sensor Readings Over Time                                       ?
?                                                                 ?
?  30°C  ? Percentage: (30-20)/(95-20)*100 = 13%                 ?
?         Color: Green (< 75°C warning)                           ?
?         Button: Green "13%"                                     ?
?                                                                 ?
?  50°C  ? Percentage: (50-20)/(95-20)*100 = 41%                 ?
?         Color: Green (< 75°C warning)                           ?
?         Button: Green "41%"                                     ?
?                                                                 ?
?  75°C  ? Percentage: (75-20)/(95-20)*100 = 73%                 ?
?         Color: Orange (>= 75°C warning, < 88°C critical)        ?
?         Button: Orange "73%"                                    ?
?                                                                 ?
?  82°C  ? Percentage: (82-20)/(95-20)*100 = 83%                 ?
?         Color: Orange (>= 75°C warning, < 88°C critical)        ?
?         Button: Orange "83%"                                    ?
?                                                                 ?
?  88°C  ? Percentage: (88-20)/(95-20)*100 = 91%                 ?
?         Color: Red (>= 88°C critical)                           ?
?         Button: Red "91%"                                       ?
?                                                                 ?
?  95°C  ? Percentage: (95-20)/(95-20)*100 = 100% (clamped)      ?
?         Color: Red (>= 88°C critical)                           ?
?         Button: Red "100%"                                      ?
?                                                                 ?
? Graph:                                                          ?
?                                                                 ?
? 100% ?                                       ?                 ?
?      ?                                     ? ?                 ?
?  88% ??????????????????????????????????????  ?                 ?
?      ?                            ? (critical threshold)        ?
?  75% ????????????????????????????           ?                 ?
?      ?           ? ? ? ?                  ?                 ?
?  50% ?      ?                               ?                 ?
?      ?   ?                                  ?                 ?
?   0% ??????????????????????????????????????????????           ?
?      ????????????????????????????????????????????           ?
?      30 50      75       88                 95  °C            ?
?        Normal   Warning   Critical                             ?
???????????????????????????????????????????????????????????????????
```

## Button State Machine

```
??????????????????????????????????????????????????????????????????
? Dial Button State Transitions                                  ?
??????????????????????????????????????????????????????????????????
                  ?
                  ?
         ??????????????????
         ? INITIAL STATE  ?
         ?  Gray Button   ?
         ?  Content: "1"  ?
         ?  No Tooltip    ?
         ??????????????????
                  ?
                  ? Monitoring Service Starts
                  ? First sensor reading received
                  ?
         ??????????????????????????????????
         ? CHECK SENSOR VALUE             ?
         ?                                ?
         ? value = 30°C                   ?
         ? warning = 75°C                 ?
         ? critical = 88°C                ?
         ??????????????????????????????????
                  ?
           ??????????????????????????
           ?             ?          ?
           ?             ?          ?
    ?????????????? ?????????? ???????????
    ?value<warn? ? ?value<crit?
    ?   YES      ? ?  YES   ?
    ?????????????? ??????????
         ?             ?
    ??????????????????????????
    ? GREEN STATE            ?
    ? Background: Green      ?
    ? Foreground: White      ?
    ? Content: "13%"         ?
    ? Tooltip: Sensor Info   ?
    ??????????????????????????
                  ?
      Sensor value rises to 75°C
      warning threshold reached
                  ?
                  ?
    ???????????????????????????
    ? CHECK SENSOR VALUE      ?
    ?                         ?
    ? value = 75°C            ?
    ? value >= warning? YES   ?
    ? value >= critical? NO   ?
    ???????????????????????????
                 ?
         ??????????????????
         ? ORANGE STATE   ?
         ? Background: #FFA500
         ? Foreground: Black
         ? Content: "73%"
         ? Tooltip: Updated
         ? Status: ? Warning
         ??????????????????
                 ?
    Sensor value rises to 88°C
    critical threshold reached
                 ?
                 ?
    ???????????????????????????
    ? CHECK SENSOR VALUE      ?
    ?                         ?
    ? value = 88°C            ?
    ? value >= critical? YES  ?
    ???????????????????????????
                 ?
         ??????????????????
         ? RED STATE      ?
         ? Background: Red?
         ? Foreground: White
         ? Content: "91%"
         ? Tooltip: Updated
         ? Status: ? Critical
         ??????????????????
                 ?
    Sensor value drops below warning
                 ?
                 ?
         ????????????????????
         ? Back to GREEN    ?
         ????????????????????
```

## Error Handling Flow

```
???????????????????????????????????????????????????????????????????
? Configuration Load Error                                        ?
???????????????????????????????????????????????????????????????????
                   ?
         ??????????????????????
         ?                    ?
         ?                    ?
    ??????????????      ??????????????????????
    ? File Not   ?      ? Invalid JSON       ?
    ? Found      ?      ? (Malformed)        ?
    ??????????????      ??????????????????????
         ?                       ?
         ?                       ?
    ???????????????????????????????????????
    ? MessageBox.Show()                   ?
    ?                                     ?
    ? "Configuration not found at:        ?
    ?  [path]                             ?
    ?  Place dials-config.json in:        ?
    ?  1. AppData\VUWare\                 ?
    ?  2. Config\ directory"              ?
    ???????????????????????????????????????
               ?                        ?
               ?                        ?
    ????????????????????    ????????????????????????
    ? StatusButton:    ?    ? StatusButton:        ?
    ? "Config Error"   ?    ? "Configuration Invalid"
    ? IsEnabled: false ?    ? IsEnabled: false     ?
    ? Color: Red       ?    ? Color: Red           ?
    ????????????????????    ????????????????????????
         ?                        ?
         ??????????????????????????
                      ?
                      ?
         ???????????????????????????
         ? Application Disabled    ?
         ? User Must Fix Config    ?
         ? & Restart App           ?
         ???????????????????????????


???????????????????????????????????????????????????????????????????
? Initialization Error                                            ?
???????????????????????????????????????????????????????????????????
                   ?
         ??????????????????????
         ?                    ?
         ?                    ?
    ???????????????      ????????????????
    ? Hub Not     ?      ? Dials Not    ?
    ? Found       ?      ? Found        ?
    ? (USB Issue) ?      ? (I2C Issue)  ?
    ???????????????      ????????????????
         ?                      ?
         ?                      ?
    ????????????????????????????????????????
    ? RaiseError() on Background Thread    ?
    ?                                      ?
    ? "Failed to connect to VU1 dials      ?
    ?  Check USB connection"               ?
    ????????????????????????????????????????
               ?                          ?
               ?                          ?
    Dispatcher.Invoke()  ??????????????????????
       to Main Thread    ? InitService_OnError?
         ?               ? Event Handler      ?
         ?               ??????????????????????
         ?                        ?
         ??????????????????????????
                      ?
                      ?
         ???????????????????????????
         ? MessageBox.Show()       ?
         ?                         ?
         ? Error message           ?
         ? [Details]               ?
         ?                         ?
         ? [OK]                    ?
         ???????????????????????????
                    ?
                    ?
         ???????????????????????????
         ? StatusButton:           ?
         ? "Initialization Failed" ?
         ? Color: Red              ?
         ???????????????????????????
                      ?
                      ?
         ???????????????????????????
         ? User Must Investigate   ?
         ? Issue & Restart App     ?
         ???????????????????????????


???????????????????????????????????????????????????????????????????
? Monitoring Error                                                ?
???????????????????????????????????????????????????????????????????
                   ?
         ???????????????????????????????????????
         ?                      ?              ?
         ?                      ?              ?
    ??????????????      ???????????????  ??????????????
    ? Sensor     ?      ? Serial      ?  ? HWInfo     ?
    ? Not Found  ?      ? Update      ?  ? Disconnect ?
    ? (Wrong     ?      ? Failed      ?  ? (User      ?
    ? Name)      ?      ? (Bad Serial)?  ? Closed)    ?
    ??????????????      ???????????????  ??????????????
         ?                     ?                ?
         ?                     ?                ?
    ???????????????????????????????????????????????
    ? Update Skipped for That Dial                ?
    ? Continue with Next Dial                     ?
    ? Log Debug Message                           ?
    ???????????????????????????????????????????????
                   ?                            ?
                   ?                            ?
    ????????????????????????    ???????????????????????????????
    ? Dial Button:         ?    ? Retry Next Monitoring Cycle ?
    ? Status Unchanged     ?    ? (1000ms later)              ?
    ? Still Shows Last %   ?    ?                             ?
    ? Still Shows Tooltip  ?    ? If persistent:              ?
    ? Monitoring continues ?    ? Fire OnError event          ?
    ????????????????????????    ? Show in StatusButton        ?
                                ???????????????????????????????
```

---

These diagrams show the complete flow from startup through steady-state monitoring, including all error paths and state transitions.
